server {
  listen 3000;

  # — Auth health (exact, no trailing-slash ambiguity)
  location = /health {
    proxy_pass http://user-auth:4000/health;
  }
  location = /health/ {
    proxy_pass http://user-auth:4000/health;
  }

  # — Auth API
  location /v1/auth/ {
    proxy_pass http://user-auth:4000/v1/auth/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }

  # — Product health
  location = /v1/product/health {
    proxy_pass http://product:4001/health;
  }
  location = /v1/product/health/ {
    proxy_pass http://product:4001/health;
  }

  # — Product API
  location /v1/product/ {
    proxy_pass http://product:4001/v1/product/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }
}
